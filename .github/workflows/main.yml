name: Trigger Cloudflare build

permissions:
  actions: write
  checks: write
  contents: write

on:
  workflow_dispatch: # Event when workflow run manually
  schedule:
    - cron: '*/10 * * * *'

jobs:
  test_job:
    name: Trigger Cloudflare build
    runs-on: ubuntu-latest
    env:
      CLOUDFLARE_BUILD_HOOK_URL: ${{secrets.CLOUDFLARE_BUILD_HOOK_URL}}
    steps:
      - name: Send POST request
        run: |
          curl -X POST "$CLOUDFLARE_BUILD_HOOK_URL"
      # - name: Checkout
      #   uses: actions/checkout@v4
      # - name: Setup Node.js environment
      #   uses: actions/setup-node@v4
      #   with: 
      #     node-version: 20
      #     cache: npm
      # - name: Install dependencies
      #   run: npm i
      # # - name: Run old script
      # #   uses: nick-fields/retry@v3
      # #   with:
      # #     timeout_minutes: 5
      # #     max_attempts: 5
      # #     command: node src/run.js
      # - name: Run build script
      #   uses: nick-fields/retry@v3
      #   with:
      #     timeout_minutes: 5
      #     max_attempts: 5
      #     command: |
      #       npm run build
      #       node dist/main.js
      # - name: Git staging
      #   run: |
      #     git config user.name "github-actions[bot]"
      #     git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
      #     git add --all
      # - name: Git commit / push
      #   continue-on-error: true
      #   run: |
      #     git commit -m 'Auto page update'
      #     git push
